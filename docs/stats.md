# Overlap Statistics — Definitions and Interpretation

This document defines each statistic generated by the overlap analysis, describes how it is calculated, and provides interpretation guidance. It also includes example tables and chart references for two specific segments.

---

## 1. Definitions

**Interaction Intensity over segment**  
- **Definition:** The cumulative number of overlap *events* across all steps in the segment. Each event is a unique interaction between a runner from event A and a runner from event B, counted for every time step where they are simultaneously within the segment and within the ±60s time window.  
- **Calculation:** Sum over all steps of the number of interacting *pairs* at that step.  
- **Interpretation:** Higher values indicate more total overlap activity across the segment, factoring in both duration and number of runners.

**Peak Congestion**  
- **Definition:** The maximum total number of runners (combined from both events) present in any single step within the segment.  
- **Calculation:** For each 30 m step in the segment, count distinct runners from both events in the ±60s window, sum them, and record the maximum value observed.  
- **Interpretation:** Shows the worst-case density in the segment. This is often the key operational choke point.

**Unique Pairs**  
- **Definition:** The number of unique (runnerA, runnerB) pairs who share the segment at any time during the race.  
- **Calculation:** Deduplicate all overlap events across the segment to count each unique pairing only once.  
- **Interpretation:** Indicates total number of distinct cross-event runner encounters.

**PeakRatio**  
- **Definition:** Ratio of peak congestion to the total field size of the smaller event.  
- **Calculation:** `Peak congestion ÷ min(total runners in event A, total runners in event B) × 100`.  
- **Interpretation:** A higher ratio means the peak congestion step contains a larger proportion of the smaller field — more acute bottleneck potential.

**Intensity/km**  
- **Definition:** Interaction Intensity normalized by segment length in km.  
- **Calculation:** `(Interaction Intensity over segment) ÷ (segment length in km)`.  
- **Interpretation:** Allows comparing segments of different lengths on equal footing.

**Intensity**  
- **Definition:** Same as "Interaction Intensity over segment". Sometimes used when segment length normalization is not needed.

**DistinctPairs**  
- **Definition:** Same as "Unique Pairs". Included as a consistency check in tabular output.

---

## 2. Additional context on Peak Congestion

Peak congestion is the **maximum simultaneous headcount** in a given 30 m step. It is driven by:  
1. **Wave timing** — when the two fields physically meet in the segment.  
2. **Field density** — how tightly packed each event’s runners are when they meet.  
3. **Speed differentials** — affecting how long runners remain in the overlap zone.

For example, in the `10K vs Half` segment from **0.00–2.74 km**:  
- Peak congestion: **222** total runners (`16` from 10K, `206` from Half) at the 2.73 km mark.  
- This represents the front wave of Half runners catching slower 10K runners shortly after the race start.

In the `10K vs Half` segment from **5.81–8.10 km**:  
- Peak congestion: **1,250** total runners (`355` from 10K, `895` from Half) at the 7.XX km mark.  
- Here, the two fields are fully merged for a prolonged distance, sustaining high counts.

---

## 3. Example: Per-step congestion tables

### Segment 1: 10K vs Half — 0.00–2.74 km

| km | 10K_runners | Half_runners | combined_runners |
|----|-------------|--------------|------------------|
| 2.25 |                  	1 |            	1 |            	2 |
| 2.28 |                  	1 |            	2 |            	3 |
| 2.31 |                  	1 |            	6 |            	7 |
| 2.34 |                  	5 |            	10 |            	15 |
| 2.37 |                  	5 |            	17 |            	22 |
| 2.4  |                  	5 |            	28 |            	33 |
| 2.43 |                  	6 |            	38 |            	44 |
| 2.46 |                  	6 |            	46 |            	52 |
| 2.49 |                  	10 |            	64 |            	74 |
| 2.52 |                  	10 |            	76 |            	86 |
| 2.55 |                  	10 |            	88 |            	98 |
| 2.58 |                  	10 |            	113 |            	123 |
| 2.61 |                  	10 |            	131 |            	141 |
| 2.64 |                  	12 |            	154 |            	166 |
| 2.67 |                  	12 |            	178 |            	190 |
| 2.7 |                  	  12 |            	189 |            	201 |
| 2.73 |                  	16 |            	206 |            	222 |

**Peak congestion:** 222 total runners at km=2.73.

Chart reference: `Per-step congestion (0.00–2.74 km).png`

---

### Segment 2: 10K vs Half — 5.81–8.10 km

| km | 10K_runners | Half_runners | combined_runners |
|----|-------------|--------------|------------------|
| 5.81 |           173 |            886 |               1059 |
| 5.84 |           174 |            889 |               1063 |
| 5.87 |           177 |            890 |               1067 |
| 5.9  |           178 |            890 |               1068 |
| 5.93 |           182 |            890 |               1072 |
| 5.96 |           183 |            888 |               1071 |
| 5.99 |           184 |            889 |               1073 |
| 6.02 |           188 |            887 |               1075 |
| 6.05 |           191 |            890 |               1081 |
| 6.08 |           191 |            880 |               1071 |

**Peak congestion:** 1,250 total runners at km≈7.xx.

Chart reference: `Per-step congestion (5.81–8.10 km).png`

---

## 4. Usage notes

- All distances are **course distances**, not straight-line GPS distances.  
- Step resolution is **0.03 km** (~30 m).  
- Time window is ±60 seconds relative to the step’s reference time.  
- Counts are **distinct runners**, not pairs.

